<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة تحكم العقارات</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 20px;
        }
        .container {
            width: 80%;
            margin: auto;
        }
        .form-container {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }
        .form-container input,
        .form-container select,
        .form-container button {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        button {
            background-color: #28a745;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background-color: #218838;
        }
        .error {
            color: red;
        }
        #propertyDetails {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
            display: none;
        }
        #propertyDetails h3 {
            margin-top: 0;
        }
    </style>
</head>
<body>

<header>
    <h1>لوحة تحكم إدارة العقارات</h1>
</header>

<div class="container">
    <div id="setPasswordForm" class="form-container">
        <h2>تعيين كلمة المرور للمشرف</h2>
        <input type="password" id="password" placeholder="أدخل كلمة المرور">
        <button onclick="setPassword()">تعيين كلمة المرور</button>
        <div id="setPasswordError" class="error"></div>
    </div>

    <div id="loginForm" class="form-container" style="display: none;">
        <h2>تسجيل الدخول</h2>
        <input type="password" id="loginPassword" placeholder="أدخل كلمة المرور">
        <button onclick="login()">تسجيل الدخول</button>
        <div id="loginError" class="error"></div>
    </div>

    <div id="propertyManagement" class="form-container" style="display: none;">
        <h2>إدارة العقارات</h2>
        
        <h3>إضافة عقار جديد</h3>
        <input type="text" id="type" placeholder="نوع العقار">
        <input type="text" id="district" placeholder="المنطقة">
        <input type="number" id="price" placeholder="السعر">
        <input type="text" id="code" placeholder="كود العقار">
        <textarea id="desc" placeholder="الوصف"></textarea>
        <input type="text" id="image" placeholder="رابط الصورة">
        <button onclick="addProperty()">إضافة العقار</button>
        <div id="addPropertyError" class="error"></div>

        <h3>البحث عن عقار</h3>
        <input type="text" id="searchCode" placeholder="أدخل كود العقار للبحث">
        <button onclick="searchProperty()">بحث</button>
        <button onclick="editProperty()">تعديل</button>
        <button onclick="deleteProperty()">حذف</button>
        <div id="propertyError" class="error"></div>

        <div id="propertyDetails">
            <h3>تفاصيل العقار</h3>
            <p><strong>النوع: </strong><span id="detailType"></span></p>
            <p><strong>المنطقة: </strong><span id="detailDistrict"></span></p>
            <p><strong>السعر: </strong><span id="detailPrice"></span></p>
            <p><strong>الوصف: </strong><span id="detailDesc"></span></p>
            <p><strong>الصورة: </strong><span id="detailImage"></span></p>
            <button onclick="saveChanges()">حفظ التغييرات</button>
        </div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-database.js"></script>
<script>
    const firebaseConfig = {
        apiKey: "your-api-key",
        authDomain: "your-auth-domain",
        databaseURL: "your-database-url",
        projectId: "your-project-id",
        storageBucket: "your-storage-bucket",
        messagingSenderId: "your-sender-id",
        appId: "your-app-id"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    function setPassword() {
        const password = document.getElementById("password").value;
        if (!password) {
            document.getElementById("setPasswordError").textContent = "يرجى إدخال كلمة المرور.";
            return;
        }

        localStorage.setItem("adminPassword", password);
        alert("تم تعيين كلمة المرور بنجاح.");
        document.getElementById("setPasswordForm").style.display = "none";
        document.getElementById("loginForm").style.display = "block";
    }

    function login() {
        const enteredPassword = document.getElementById("loginPassword").value;
        const storedPassword = localStorage.getItem("adminPassword");

        if (enteredPassword === storedPassword) {
            alert("تم تسجيل الدخول بنجاح.");
            document.getElementById("loginForm").style.display = "none";
            document.getElementById("propertyManagement").style.display = "block";
        } else {
            document.getElementById("loginError").textContent = "كلمة المرور غير صحيحة.";
        }
    }

    function checkPasswordSet() {
        const storedPassword = localStorage.getItem("adminPassword");
        if (!storedPassword) {
            document.getElementById("setPasswordForm").style.display = "block";
        } else {
            document.getElementById("loginForm").style.display = "block";
        }
    }

    function addProperty() {
        const type = document.getElementById("type").value;
        const district = document.getElementById("district").value;
        const price = document.getElementById("price").value;
        const code = document.getElementById("code").value;
        const desc = document.getElementById("desc").value;
        const image = document.getElementById("image").value;
        const errorMsg = document.getElementById("addPropertyError");

        if (!type || !district || !price || !code || !desc || !image) {
            errorMsg.textContent = "جميع الحقول مطلوبة.";
            return;
        }

        const newProperty = {
            type,
            district,
            price,
            code,
            desc,
            image
        };

        database.ref("properties/" + code).set(newProperty)
            .then(() => {
                alert("تم إضافة العقار بنجاح!");
            })
            .catch(() => {
                errorMsg.textContent = "حدث خطأ أثناء إضافة العقار.";
            });
    }

    function searchProperty() {
        const code = document.getElementById("searchCode").value;
        const propertyDetails = document.getElementById("propertyDetails");
        const errorMsg = document.getElementById("propertyError");

        if (!code) {
            errorMsg.textContent = "يرجى إدخال كود العقار.";
            return;
        }

        database.ref("properties/" + code).get()
            .then((snapshot) => {
                if (snapshot.exists()) {
                    const property = snapshot.val();
                    document.getElementById("detailType").textContent = property.type;
                    document.getElementById("detailDistrict").textContent = property.district;
                    document.getElementById("detailPrice").textContent = property.price;
                    document.getElementById("detailDesc").textContent = property.desc;
                    document.getElementById("detailImage").textContent = property.image;
                    propertyDetails.style.display = "block";
                } else {
                    errorMsg.textContent = "العقار غير موجود.";
                }
            })
            .catch(() => {
                errorMsg.textContent = "حدث خطأ أثناء البحث.";
            });
    }

    function editProperty() {
        const code = document.getElementById("searchCode").value;
        const propertyDetails = document.getElementById("propertyDetails");

        if (!code) {
            alert("يرجى إدخال كود العقار أولاً.");
            return;
        }

        alert("تم الانتقال إلى وضع التعديل.");
    }

    function deleteProperty() {
        const code = document.getElementById("searchCode").value;
        const errorMsg = document.getElementById("propertyError");

        if (!code) {
            errorMsg.textContent = "يرجى إدخال كود العقار.";
            return;
        }

        database.ref("properties/" + code).remove()
            .then(() => {
                alert("تم حذف العقار بنجاح!");
                document.getElementById("propertyDetails").style.display = "none";
            })
            .catch(() => {
                errorMsg.textContent = "حدث خطأ أثناء حذف العقار.";
            });
    }

    function saveChanges() {
        const code = document.getElementById("searchCode").value;
        const errorMsg = document.getElementById("propertyError");

        if (!code) {
            errorMsg.textContent = "يرجى إدخال كود العقار.";
            return;
        }

        const updatedProperty = {
            type: document.getElementById("detailType").textContent,
            district: document.getElementById("detailDistrict").textContent,
            price: document.getElementById("detailPrice").textContent,
            desc: document.getElementById("detailDesc").textContent,
            image: document.getElementById("detailImage").textContent
        };

        database.ref("properties/" + code).set(updatedProperty)
            .then(() => {
                alert("تم حفظ التغييرات بنجاح!");
            })
            .catch(() => {
                errorMsg.textContent = "حدث خطأ أثناء حفظ التغييرات.";
            });
    }

    checkPasswordSet();
</script>

</body>
</html>
